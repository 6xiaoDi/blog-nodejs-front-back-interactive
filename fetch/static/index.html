<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta http-equiv="X-UA-Compatible" content="ie=edge">
	<title>Document</title>
</head>

<body>
<!-- <form action="" enctype="application/x-www-form-urlencoded"></form> -->
<button class="btn1">点击发送fetch请求get</button>
<button class="btn2">点击发送fetch请求post</button>
</body>
<script>
    document.querySelector(".btn1").onclick = function () {
        fetch("/get?name=zhangsan").then(res=>{
            // 返还的是response对象；
            console.log(res);
            // 直接拿response是看不到结果的，得取它的text()才行，下一个then里获取
            return res.text();
        }).then(res=>{
            // 在这里获取response的结果
            console.log(res);
            // promise对象提供catch方法
        }).catch(err=>{
            console.log(err);
        })
    }
    document.querySelector(".btn2").onclick = function () {
        let myHeaders = new Headers();
        // myHeaders.append( "content-type","application/x-www-form-urlencoded");  //---->（querystring）body:"name=zhangsan&age=20"
        myHeaders.append( "content-type","application/json");  //  --->（JSON）body:JSON.stringify({name:"张三",age:30})
        myHeaders.append( "x-custom","somevalue");
        // post提供配置参数对象
        fetch("/post",{
            method:"post",
            // body:"name=zhangsan&age=20", // querystring方式
            body:JSON.stringify({name:"张三",age:30}),
            // headers:{
            //     "content-type":"application/x-www-form-urlencoded", // 可追加更多的头
            //     "x-custom":"somevalue" // 可自定义
            // }
            headers:myHeaders
        }).then(res=>{
            // 返还的是response对象；
            // console.log(res);
            // return res.text();
            // return res.json(); //Json对象，但有可能涉及传址问题，后续要是修改就容易出问题，建议深拷贝
            return res.clone(); // 深拷贝，不会影响原对象
        }).then(res=>{
            console.log(res);
        }).catch(err=>{
            console.log(err);
        })
    }
</script>
</html>